import numpy as np
import matplotlib.pyplot as plt
from matplotlib import dates, ticker
import matplotlib as mpl
from mpl_finance import candlestick_ohlc

mpl.style.use('default')

data = [["2018-04-24 09:15:00",10581.8, 10597.05, 10576.2, 10593.05],["2018-04-24 09:20:00",10593.05, 10598.8, 10590.1, 10593.0],["2018-04-24 09:25:00",10593.0, 10598.0, 10592.05, 10596.8],["2018-04-24 09:30:00",10596.8, 10597.6, 10584.75, 10587.95],["2018-04-24 09:35:00",10588.15, 10590.0, 10582.8, 10585.0],["2018-04-24 09:40:00",10585.0, 10591.5, 10583.75, 10588.0],["2018-04-24 09:45:00",10589.4, 10592.35, 10586.0, 10587.8],["2018-04-24 09:50:00",10589.0, 10596.75, 10588.6, 10594.85],["2018-04-24 09:55:00",10594.85, 10595.4, 10588.95, 10589.45],["2018-04-24 10:00:00",10589.45, 10591.3, 10587.25, 10588.0],["2018-04-24 10:05:00",10588.0, 10589.5, 10585.0, 10588.0],["2018-04-24 10:10:00",10588.0, 10593.5, 10587.45, 10591.75],["2018-04-24 10:15:00",10593.4, 10594.45, 10588.4, 10590.6],["2018-04-24 10:20:00",10590.6, 10592.6, 10588.0, 10589.65],["2018-04-24 10:25:00",10589.7, 10590.45, 10586.1, 10588.25],["2018-04-24 10:30:00",10589.0, 10591.45, 10587.0, 10588.5],["2018-04-24 10:35:00",10588.5, 10593.5, 10587.3, 10591.1],["2018-04-24 10:40:00",10591.1, 10597.8, 10591.1, 10596.45],["2018-04-24 10:45:00",10596.05, 10597.75, 10594.0, 10595.45],["2018-04-24 10:50:00",10595.45, 10599.4, 10594.0, 10594.05],["2018-04-24 10:55:00",10594.05, 10597.5, 10593.25, 10595.5],["2018-04-24 11:00:00",10595.5, 10598.0, 10593.5, 10596.8],["2018-04-24 11:05:00",10596.6, 10596.6, 10588.25, 10592.05],["2018-04-24 11:10:00",10592.05, 10595.05, 10590.7, 10593.2],["2018-04-24 11:15:00",10592.65, 10593.15, 10590.15, 10592.0],["2018-04-24 11:20:00",10592.5, 10595.95, 10591.5, 10595.0],["2018-04-24 11:25:00",10595.0, 10595.0, 10591.4, 10594.95],["2018-04-24 11:30:00",10595.0, 10598.75, 10593.8, 10596.15],["2018-04-24 11:35:00",10596.15, 10596.95, 10593.55, 10594.15],["2018-04-24 11:40:00",10594.15, 10595.25, 10591.2, 10593.8],["2018-04-24 11:45:00",10593.8, 10596.65, 10592.05, 10594.5],["2018-04-24 11:50:00",10594.5, 10596.1, 10594.5, 10595.35],["2018-04-24 11:55:00",10594.3, 10597.0, 10593.75, 10594.0], ["2018-04-24 12:00:00",10594.0, 10596.0, 10590.95, 10591.65], ["2018-04-24 12:05:00",10591.65, 10596.15, 10591.0, 10594.05], ["2018-04-24 12:10:00",10594.05, 10595.0, 10590.0, 10590.3], ["2018-04-24 12:15:00",10590.3, 10593.1, 10589.4, 10589.5], ["2018-04-24 12:20:00",10589.5, 10592.5, 10588.6, 10591.0], ["2018-04-24 12:25:00",10590.65, 10591.1, 10587.8, 10590.0], ["2018-04-24 12:30:00",10590.0, 10590.45, 10584.2, 10585.7], ["2018-04-24 12:35:00",10585.95, 10585.95, 10576.15, 10579.5], ["2018-04-24 12:40:00",10579.0, 10579.95, 10568.95, 10572.25], ["2018-04-24 12:45:00",10571.05, 10584.0, 10570.0, 10582.95], ["2018-04-24 12:50:00",10582.95, 10586.0, 10581.05, 10582.0], ["2018-04-24 12:55:00",10581.25, 10584.1, 10579.4, 10582.0], ["2018-04-24 13:00:00",10581.95, 10586.25, 10580.1, 10585.0], ["2018-04-24 13:05:00",10585.0, 10585.9, 10578.6, 10579.0], ["2018-04-24 13:10:00",10579.0, 10586.95, 10578.0, 10586.2], ["2018-04-24 13:15:00",10586.0, 10587.65, 10584.5, 10586.15], ["2018-04-24 13:20:00",10586.15, 10592.0, 10586.0, 10590.25], ["2018-04-24 13:25:00",10590.25, 10595.95, 10590.0, 10594.05], ["2018-04-24 13:30:00",10594.05, 10606.05, 10594.0, 10603.35], ["2018-04-24 13:35:00",10604.0, 10605.15, 10597.15, 10604.95], ["2018-04-24 13:40:00",10606.0, 10606.9, 10599.2, 10602.5], ["2018-04-24 13:45:00",10602.5, 10611.95, 10602.5, 10607.65], ["2018-04-24 13:50:00",10606.9, 10609.75, 10604.0, 10607.0], ["2018-04-24 13:55:00",10606.6, 10610.5, 10604.1, 10609.75], ["2018-04-24 14:00:00",10608.0, 10608.0, 10599.55, 10599.55], ["2018-04-24 14:05:00",10599.55, 10606.05, 10599.0, 10604.5], ["2018-04-24 14:10:00",10605.05, 10608.05, 10602.0, 10604.05], ["2018-04-24 14:15:00",10604.05, 10609.45, 10601.0, 10605.85], ["2018-04-24 14:20:00",10606.1, 10616.8, 10606.0, 10612.3], ["2018-04-24 14:25:00",10612.2, 10620.05, 10611.05, 10619.45], ["2018-04-24 14:30:00",10619.45, 10628.4, 10619.4, 10623.8], ["2018-04-24 14:35:00",10623.8, 10634.7, 10623.8, 10631.0], ["2018-04-24 14:40:00",10631.55, 10634.25, 10616.75, 10625.9], ["2018-04-24 14:45:00",10625.9, 10629.8, 10621.7, 10627.0], ["2018-04-24 14:50:00",10627.0, 10628.9, 10624.0, 10627.75], ["2018-04-24 14:55:00",10628.45, 10631.0, 10625.0, 10629.2], ["2018-04-24 15:01:00",10620.2, 10620.45, 10611.05, 10618.4], ["2018-04-24 15:05:00",10618.4, 10623.2, 10614.1, 10617.85], ["2018-04-24 15:10:00",10617.3, 10620.5, 10612.55, 10616.05], ["2018-04-24 15:15:00",10616.4, 10621.85, 10613.7, 10619.7], ["2018-04-24 15:20:00",10619.7, 10619.9, 10616.85, 10618.0], ["2018-04-24 15:25:00",10617.65, 10622.95, 10616.1, 10620.1]]

ohlc_data = []

for line in data:
    ohlc_data.append((dates.datestr2num(line[0]), np.float64(line[1]), np.float64(line[2]), np.float64(line[3]), np.float64(line[4])))

fig, ax1 = plt.subplots()
candlestick_ohlc(ax1, ohlc_data, width = 0.6/(24*60), colorup = 'g', colordown = 'r', alpha = 0.8)

ax1.xaxis.set_major_formatter(dates.DateFormatter('%H:%M'))
ax1.xaxis.set_major_locator(ticker.MaxNLocator(25))

plt.xticks(rotation = 30)
plt.xlabel('Time')
plt.ylabel('Price')
plt.title('Nifty Apr Future')
plt.tight_layout()
plt.show()